<!-- Author: Kobe Dait -->
<!-- File Description: Login Page -->

<script>
  let params = (new URL(document.location)).searchParams;
  if (params.has("LoginError")) { // If has login errors from query
    window.onload = function () { // Page loads
      loginError = params.get("LoginError"); // Defines loginError when getting LoginError from server
      wrongPass = '<font color="red">Incorrect Password</font>'; // Error message assigned into wrongPass
      notReg = params.get("LoginError"); //get the login error and assign it into variable
      if (loginError == wrongPass) { //if the loginError equals the same error stored in the variable
        document.getElementById("passwordlabel").innerHTML = loginError; // Displays password error in passwordlabel
        loginError = ''; // Resets login error on page refresh
      }
      if (loginError == notReg) { // If the loginError equals the same error stored in the variable
        document.getElementById("usernamelabel").innerHTML = loginError; // Displays username error in usernamelabel
        loginError = ''; // Resets login error on page refresh
      }
      if (params.has("logStickInput")) { // If has user input from query
        stickTheInput = params.get("logStickInput"); // Gets log and assigns to variable
        document.getElementById("userBox").value = stickTheInput; // Sets the value of the input box to equal what was entered from the user
        loginError = ''; // Resets login error on page refresh
      }
    }
  } 
</script>

<!-- HTML format from https://darkcode1.blogspot.com/2019/07/animated-login-form-using-html-css.html -->
<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <title>Login</title>
  <link rel="stylesheet" href="loyalty.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" charset="utf-8"></script>
</head>

<body>
  <form name="loginName" class="login-form" method="POST">
    <img id="mb-logo" src="./images/mb-white-logo.png">
    <div class="txtb">
      <input id="userBox" type="text" name="username" onchange="javascript:this.value = this.value.toLowerCase();"
        required>
      <!--Makes the username case-insensitive-->
      <span data-placeholder="Username"></span>
    </div>
    <div id="usernamelabel"></div>

    <div class="txtb">
      <input type="password" name="password" required>
      <span data-placeholder="Password"></span>
    </div>
    <div id="passwordlabel"></div>
    <br>
    <input name="login_submit_button" type="submit" class="logbtn" value="Login">
  </form>

  <!-- Script from https://darkcode1.blogspot.com/2019/07/animated-login-form-using-html-css.html -->
  <script type="text/javascript">
    // Creates the animaitons on Login form
    $(".txtb input").on("focus", function () {
      $(this).addClass("focus");
    });

    $(".txtb input").on("blur", function () {
      if ($(this).val() == "")
        $(this).removeClass("focus");
    });
  </script>
</body>

</html>
<script>
  // Source from Shane Shimizu
  // Sets link with quantity data to pass to next page
  registrationpage.href = "results_display.html" + document.location.search;
  loginName.action = "./login_form" + document.location.search; 
</script>